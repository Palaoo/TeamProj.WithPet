<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <th:block th:replace="fragments/index::style"></th:block>
</head>

<body>
<div th:replace="fragments/index :: header"></div>

<!-- Blog Details Hero Begin -->
<section class="blog-hero spad">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="col-lg-9 text-center">
                <div class="blog__hero__text">
                    <h2 th:text="${title}"> Are you one of the thousands of Iphone owners who has no idea</h2>
                    <ul>
                        <li th:text="${writer}">By Deercreative</li>
                        <li th:text="${date}">February 21, 2019</li>
                       <!-- <li>8 Comments</li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Blog Details Hero End -->

<!-- Blog Details Section Begin -->
<section class="blog-details spad">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="col-lg-12">
                <div class="blog__details__pic">
                    <img src="" alt="">
                </div>
            </div>
            <div class="col-lg-8">
                <div class="blog__details__content">
<!--                    <div class="blog__details__share">-->
<!--                        <span>share</span>-->
<!--                        <ul>-->
<!--                            <li><a href="#"><i class="fa fa-facebook"></i></a></li>-->
<!--                            <li><a href="#" class="twitter"><i class="fa fa-twitter"></i></a></li>-->
<!--                            <li><a href="#" class="youtube"><i class="fa fa-youtube-play"></i></a></li>-->
<!--                            <li><a href="#" class="linkedin"><i class="fa fa-linkedin"></i></a></li>-->
<!--                        </ul>-->
<!--                    </div>-->
                    <div class="blog__details__text">
                        <p th:utext="${content}"></p>
                    </div>
                    <div th:if="${#strings.equals(userid, writer)}">
                        <input type="button" id="modify" value="수정" th:href="@{/community/modifypost(boardcode=${boardcode})}">
                        <input type="button" id="delete" value="삭제">
                    </div>

                    <div class="blog__details__comment">
                        <!--<h4>Leave A Comment</h4>-->
                        <form action="#">
                            <div class="row">
                                <div class="col-lg-12 text-center">
                                   <!-- <textarea placeholder="Comment"></textarea>
                                    <button type="submit" class="site-btn">Post Comment</button>-->

                                    <div th:if="${not #strings.isEmpty(userid)}">
                                        <form action="newreply" method="post">
                                            <table id="rtable2">
                                                <tr><td id="writer"><th:block th:text="${userid}" name="writer" class="col-lg-2 col-md-2"></th:block></td>
                                                    <td class="col-lg-8 col-md-8"><textarea name="content" id="content" placeholder="댓글 달기"></textarea></td>
                                                    <input type="hidden" name="boardcode" th:value="${boardcode}" id="boardcode">
                                                    <td class="col-lg-2 col-md-2"><input type="submit" class="site-btn" value="작성" id="addReply"></td></tr>
                                            </table>
                                            <table id="rtable" align="center">
                                            </table>
                                        </form>
                                    </div>
                                    <div  th:if="${#strings.isEmpty(userid)}">
                                        <textarea placeholder="댓글을 작성하시려면 로그인해주세요." readonly></textarea>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Blog Details Section End -->

<!--<div class="row">
    <div class="col-xs-1 col-sm-12">
        <h3 th:text="${title}">게시물 제목</h3>
        <th:block th:text="${writer}"></th:block> | <th:block th:text="${date}"></th:block>
    </div>
    <br>
    <div class="row">
        <div class="col-sm-12">
            <th:block th:utext="${content}"></th:block>
        </div>
        <div class="col-sm-12">
            <h4>댓글</h4>
        </div>
        <div class="col-sm-12">
            <table>

            </table>
        </div>
        <div th:if="${not #strings.isEmpty(userid)}" class="col-sm-12">
            <form action="newreply" method="post">
            <table id="rtable2">
                <tr><td id="writer"><th:block th:text="${userid}" name="writer"></th:block></td>
                    <td><textarea name="content" id="content" placeholder="댓글 달기"></textarea></td>
                    <input type="hidden" name="boardcode" th:value="${boardcode}" id="boardcode">
                    <td><input type="button" value="작성" id="addReply"></td></tr>
            </table>
            <table id="rtable">
            </table>
            </form>
        </div>
        <div  th:if="${#strings.isEmpty(userid)}" class="col-sm-12">
            <textarea readonly>댓글을 작성하시려면 로그인해주세요.</textarea>
        </div>
        <div class="row">
            <div class="col-sm-12"></div>
        </div>
    </div>
</div>-->

<th:block th:replace="fragments/index :: footer"></th:block>

</body>
<script>
    $(document)
        .ready(function(){
            $.ajax({
                url:'/community/postdetail',
                type:'post',
                data:{boardcode:$('#boardcode').val()},
                success:function(data){
                    $(data).each(function(){
                        $('#rtable').append('<tr><td>'+this.writer+'</td><td>'+this.content
                            +'</td><td>'+this.date+'</td></tr>')
                    })
                }
            })
        })
        .on('click','#addReply',function(){
            $.ajax({
                url:'/community/newreply',
                type:'post',
                data:{writer:$('#writer').text(),content:$('textarea#content').val(),boardcode:$('#boardcode').val()},
                beforeSend: function (){
                    $('#rtable').empty()
                },
                success:function(data){
                    $(data).each(function(){
                        $('#rtable').append('<tr><td>'+this.writer+'</td><td>'+this.content
                                +'</td><td>'+this.date+'</td></tr>')
                    })
                }
            })
        })

        .on('click', '#delete', function (){
            var answer = confirm('정말 삭제하시겠습니까?')
            if(answer){
                location.href="/community/delete?boardcode="+$('#boardcode').val()
            } else {
                return false;
            }
        })

        .on('click', '#modify', function (){
            location.href="/community/modifypost?boardcode="+$('#boardcode').val()
        })



</script>

</html>