<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>mall proto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">

</head>

<style>
    #login,
    #signin,
    #myshopping,
    #basket_shopping,
    #userInfo,
    #cafename {
        text-decoration: none;
        color: black;
    }

    nav a {
        text-decoration: none;
        color: black;
        margin: 2em;
    }

    nav {
        display: flex;
        justify-content: center;
    }

    .div1 {
        width: 95%;
        height: 600px;
        margin: auto;
    }

    .div-imgcontainer {
        width: 50vh;
        height: 50vw;
        float: left;
    }

    .div-right {
        width: 50%;
        height: 95%;
        float: right;
    }
</style>

<body>

    <p align=right><a id="myshopping" href='myshopping'>마이쇼핑</a>&nbsp;&nbsp;<a id="basket_shopping"
            href='basket_view'>장바구니</a>&nbsp;&nbsp;<a id="userInfo" href='userInfo'>회원정보</a>&nbsp;&nbsp;<a id="login"
            href='Login'>로그인</a></p>
    <h1 id="logo" align=center>WITH PET</h1>
    <nav>
        <a href="#">숙소</a>
        <a href="#">카페</a>
        <a href="#">맛집</a>
        <a href="mallPage">상점</a>
        <a href="#">게시판</a>
    </nav>

    <hr>

    <div class="div1">
        <div class='div-imgcontainer'>
            <img th:src="${img}" id="prod_img" width="300" height="300">
        </div>
        <div class="div-right">
            <p th:text="${product.name}">상품명</p><br>
            <p th:text="${product.price}" id="price">가격</p><br>
            <input type="hidden" name="prodId" id="prodId" th:value="${product.id}">

            <table>
                <tr>
                    <td>
                        <span class="quantity">
                            <input id="quantity" name="quantity_name" style="" value="1" type="text" /> <button
                                id="btnQuantityUp"><img
                                    src="//img.echosting.cafe24.com/skin/base_ko_KR/product/btn_count_up.gif" alt="수량증가"
                                    class="QuantityUp up" /></button>
                            <button id="btnQuantityDown"><img
                                    src="//img.echosting.cafe24.com/skin/base_ko_KR/product/btn_count_down.gif"
                                    alt="수량감소" class="QuantityDown down" /></button>
                        </span>
                    </td>
                    <td class="right">
                        <span class="quantity_price" id="totalPrice" th:text="${product.price}">19800</span> <span
                            class="mileage displaynone">(<img src="" /> <span class="mileage_price"></span>)</span>
                    </td>
                </tr>
            </table>

            <input type="button" id="payment" value="TossPay 결제"><br>
            <input type="button" id="bascket" value="장바구니">
        </div>
    </div>

    <hr>

    <div>
        리뷰 div
    </div>

    <hr>

    <div>
        <div>
            상품 상세정보 div<br>
            <p name="" id="" cols="30" rows="10" th:utext="${product.detail}"></p>
        </div>
    </div>


</body>
<script src="https://js.tosspayments.com/v1"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {

    }).on('click', '#payment', function () {
        tossPayments()
    }).on('click', '#btnQuantityUp', function () {
        $('#quantity').val(parseInt($('#quantity').val()) + 1);
        $('#totalPrice').text(parseInt($('#price').text()) * parseInt($('#quantity').val()))
    }).on('click', '#btnQuantityDown', function () {
        $('#quantity').val(parseInt($('#quantity').val()) - 1);
        $('#totalPrice').text(parseInt($('#price').text()) * parseInt($('#quantity').val()))
    }).on('click', '#bascket', function () {
        $.ajax({
            type: 'get', url: 'append_basket?prodId=' + $('#prodId').val(),
            success: function () {
                alert('장바구니에 추가되었습니다.')
            }
        })
    })

    $('#logo').on('click', function () {
        location = '/';
    })

    function tossPayments() {
        let clientKey = 'test_ck_mnRQoOaPz8L0knPzxY58y47BMw6v'
        let tossPayments = TossPayments(clientKey)
        let totalPrice = parseInt($('#totalPrice').text());
        tossPayments.requestPayment('카드', {
            // 결제 수단 파라미터
            // 결제 정보 파라미터
            amount: totalPrice,
            orderId: 'L6o8LEvy99H1wUTR6vOT3',
            orderName: '토스 티셔츠 외 2건',
            customerName: '박토스',
            successUrl: 'http://localhost:8080/paysuccess'
                + '?priceid=' + $('#prodId').val() + '&count=' + $('#quantity').val(),
            failUrl: 'http://localhost:8080/payfail',
        })
    }
</script>

</html>